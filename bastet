#!/bin/bash 

### Setting the arguments
args=(
    "install" 
    "remove" 
    "purge" 
    "sync" 
    "update" 
    "live-update" 
    "search"
    "syncrepo"
    "sysclean"
    "addrepo"
    "delrepo"
    "supdate"
)

### Checking if the config file exists and using it when available
if test -f /etc/bastet/config; then
    zugaina="$(grep zugaina /etc/bastet/config | cut -c 11-)"
    eixcheck="$(grep eix /etc/bastet/config | cut -c 7-)"
else
    zugaina=true
    eixcheck=true
fi

### Checking if eix is installed
if [ "$eixcheck" == true ]; then
    if test -f /usr/bin/eix; then
        eix=true
    else
        eix=false
    fi
fi

### checking and executing arguments
case "$1" in
    "${args[0]}")
        shift
        emerge -av $*
          ;;
    "${args[1]}")
        shift
        emerge -a --depclean $*
          ;;
    "${args[2]}")
        shift
        emerge -aC $*
          ;;
    "${args[3]}")
        if [ "$eix" == true ]; then
            eix-sync
        else
            emerge --sync
        fi
          ;;
    "${args[4]}")
        emerge -avuND @world
          ;;
    "${args[5]}")
        if test -f /usr/bin/smart-live-rebuild; then
            smart-live-rebuild
        else
            printf "%s\n" "You don't have 'smart-live-rebuild' installed!"
        fi
          ;;
    "${args[6]}")
        if [ "$eix" == true ]; then
            shift
            eix -R $*
            if [ "$zugaina" == true ]; then
                printf "\n"
                printf "%s\n" "Zugaina search:"
                printf "%s\n" "http://gpo.zugaina.org/Search?search=$*"
            fi
        else
            shift
            emerge --search $*
            if [ "$zugaina" == true ]; then
                printf "\n"
                printf "%s\n" "Zugaina search:"
                printf "%s\n" "http://gpo.zugaina.org/Search?search=$*"
            fi
        fi
          ;;
    "${args[7]}")
        shift
        emaint -r $1 sync
          ;;
    "${args[8]}")
        shift
        emerge -a --depclean
          ;;
    "${args[9]}")
        if test -f /usr/bin/layman; then
            shift
            layman -a $1
        else
            printf "%s\n" "Layman is not installed!"
        fi
          ;;
    "${args[10]}")
        if test -f /usr/bin/layman; then
            shift
            layman -d $1
        else
            printf "%s\n" "Layman is not installed!"
        fi
          ;;
    "${args[11]}")
        if [ "$eix" == true ]; then
            eix-sync && emerge -avuND @world
        else
            emerge --sync && emerge -avuND @world
        fi
          ;;
esac 